<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Статистика казино</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>

body{
background:#0f3b2f;
color:white;
font-family:Arial;
text-align:center;
}

.table{
display:flex;
justify-content:center;
margin-top:20px;
}

.zeros{
display:flex;
flex-direction:column;
margin-right:5px;
}

.grid{
display:grid;
grid-template-columns: repeat(12, 55px);
grid-template-rows: repeat(3, 55px);
gap:4px;
}

button{
width:55px;
height:55px;
border:none;
font-weight:bold;
cursor:pointer;
color:white;
font-size:16px;
}

.control-btn{
background:#000;
color:white;
border:1px solid #444;
width:auto;
height:auto;
padding:10px 20px;
margin:5px;
font-size:14px;
font-weight:bold;
}

.control-btn:hover{
background:#222;
}

.red{background:#c0392b;}
.black{background:#111;}
.green{background:#1e8449;}

.history{
background:#111;
padding:10px;
margin:20px;
display:flex;
flex-wrap:wrap;
gap:4px;
justify-content:center;
}

.hist{
width:35px;
height:35px;
display:flex;
justify-content:center;
align-items:center;
font-weight:bold;
}

.panel{
display:flex;
flex-wrap:wrap;
justify-content:center;
gap:15px;
margin-top:20px;
}

.box{
background:#111;
padding:10px;
width:260px;
text-align:left;
}

</style>
</head>
<body>

<h2>Анализ рулетки PRO</h2>

<div class="table">

<div class="zeros">
<button class="green" onclick="addNumber('0')">0</button>
<button class="green" onclick="addNumber('00')">00</button>
</div>

<div class="grid" id="grid"></div>

</div>

<div class="history" id="history"></div>

<div class="panel">

<div class="box">
<b>Prediction:</b><br>
Число: <span id="predictionNumber">-</span><br>
Вероятность: <span id="predictionProb">-</span>
</div>

<div class="box">
<b>Цвета:</b><br>
Red: <span id="probRed">0</span>%<br>
Black: <span id="probBlack">0</span>%<br>
Green: <span id="probGreen">0</span>%
</div>

<div class="box">
<b>Сектора:</b><br>
1-12: <span id="probS1">0</span>%<br>
13-24: <span id="probS2">0</span>%<br>
25-36: <span id="probS3">0</span>%
</div>

<div class="box">
<b>Линии:</b><br>
Col1: <span id="probC1">0</span>%<br>
Col2: <span id="probC2">0</span>%<br>
Col3: <span id="probC3">0</span>%
</div>

<div class="box">
<b>Половины:</b><br>
1-18: <span id="probH1">0</span>%<br>
19-36: <span id="probH2">0</span>%
</div>

<div class="box">
<b>Четность:</b><br>
Even: <span id="probEven">0</span>%<br>
Odd: <span id="probOdd">0</span>%
</div>

</div>

<br>

<button class="control-btn" onclick="exportExcel()">Excel</button>
<button class="control-btn" onclick="saveJSON()">Save JSON</button>
<button class="control-btn" onclick="importJSON()">Import JSON</button>
<button class="control-btn" onclick="clearAll()">Clear</button>

<input type="file" id="fileInput" hidden>

<script>

const redNums=[1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];

let history=[];

let stats={
red:0,black:0,green:0,
s1:0,s2:0,s3:0,
c1:0,c2:0,c3:0,
h1:0,h2:0,
even:0,odd:0
};

let numberCount={};

for(let i=0;i<=36;i++) numberCount[i]=0;
numberCount["00"]=0;


// создать стол

const grid=document.getElementById("grid");

for(let r=3;r>=1;r--){
for(let c=0;c<12;c++){

let n=r+c*3;

let b=document.createElement("button");

b.innerText=n;
b.className=getColor(n);

b.onclick=()=>addNumber(n);

grid.appendChild(b);

}
}


// цвет

function getColor(n){

if(n=="0"||n=="00") return "green";

return redNums.includes(Number(n))?"red":"black";

}


// добавить

function addNumber(n){

let color=getColor(n);

history.push({number:n,color});

stats[color]++;

if(n>=1 && n<=12) stats.s1++;
if(n>=13 && n<=24) stats.s2++;
if(n>=25 && n<=36) stats.s3++;

if(n%3==1) stats.c1++;
if(n%3==2) stats.c2++;
if(n%3==0) stats.c3++;

if(n>=1 && n<=18) stats.h1++;
if(n>=19 && n<=36) stats.h2++;

if(n%2==0) stats.even++;
else stats.odd++;

numberCount[n]++;

render();

saveLocal();

}


// render

function render(){

let div=document.getElementById("history");

div.innerHTML="";

history.forEach(h=>{

let el=document.createElement("div");

el.className="hist "+h.color;
el.innerText=h.number;

div.appendChild(el);

});

updateProbabilities();

updatePrediction();

}


// вероятности

function updateProbabilities(){

let total=history.length || 1;

document.getElementById("probRed").innerText=((stats.red/total)*100).toFixed(1);
document.getElementById("probBlack").innerText=((stats.black/total)*100).toFixed(1);
document.getElementById("probGreen").innerText=((stats.green/total)*100).toFixed(1);

document.getElementById("probS1").innerText=((stats.s1/total)*100).toFixed(1);
document.getElementById("probS2").innerText=((stats.s2/total)*100).toFixed(1);
document.getElementById("probS3").innerText=((stats.s3/total)*100).toFixed(1);

document.getElementById("probC1").innerText=((stats.c1/total)*100).toFixed(1);
document.getElementById("probC2").innerText=((stats.c2/total)*100).toFixed(1);
document.getElementById("probC3").innerText=((stats.c3/total)*100).toFixed(1);

document.getElementById("probH1").innerText=((stats.h1/total)*100).toFixed(1);
document.getElementById("probH2").innerText=((stats.h2/total)*100).toFixed(1);

document.getElementById("probEven").innerText=((stats.even/total)*100).toFixed(1);
document.getElementById("probOdd").innerText=((stats.odd/total)*100).toFixed(1);

}


// prediction

function updatePrediction(){

let total=history.length;

if(total==0) return;

let best="-";
let bestScore=0;

Object.keys(numberCount).forEach(n=>{

let score=numberCount[n]/total;

if(score>bestScore){

bestScore=score;
best=n;

}

});

document.getElementById("predictionNumber").innerText=best;
document.getElementById("predictionProb").innerText=(bestScore*100).toFixed(2)+"%";

}


// storage

function saveLocal(){
localStorage.setItem("roulette",JSON.stringify(history));
}

function loadLocal(){

let d=localStorage.getItem("roulette");

if(d){

JSON.parse(d).forEach(x=>addNumber(x.number));

}

}

loadLocal();


// export

function exportExcel(){

let ws=XLSX.utils.json_to_sheet(history);
let wb=XLSX.utils.book_new();

XLSX.utils.book_append_sheet(wb,ws,"history");

XLSX.writeFile(wb,"roulette.xlsx");

}

function saveJSON(){

let blob=new Blob([JSON.stringify(history)],{type:"application/json"});

let a=document.createElement("a");

a.href=URL.createObjectURL(blob);

a.download="roulette.json";

a.click();

}

function importJSON(){

document.getElementById("fileInput").click();

}

document.getElementById("fileInput").onchange=function(e){

let file=e.target.files[0];

let reader=new FileReader();

reader.onload=function(){

clearAll();

JSON.parse(reader.result).forEach(x=>addNumber(x.number));

};

reader.readAsText(file);

};


function clearAll(){

history=[];

for(let k in stats) stats[k]=0;

for(let i=0;i<=36;i++) numberCount[i]=0;
numberCount["00"]=0;

render();

saveLocal();

}

</script>

</body>
</html>