<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Roulette Analyzer PRO</title>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>

body{
background:#0f3b2f;
color:white;
font-family:Arial;
margin:0;
}

.container{
display:flex;
flex-direction:column;
align-items:center;
margin-top:20px;
}

/* MENU */

.menuButton{
position:fixed;
top:15px;
right:15px;
background:black;
border:3px solid white;
padding:8px 14px;
font-size:28px;
cursor:pointer;
z-index:1002;
}

.overlay{
position:fixed;
width:100%;
height:100%;
background:rgba(0,0,0,0.6);
opacity:0;
pointer-events:none;
transition:0.3s;
z-index:999;
}

.overlay.show{
opacity:1;
pointer-events:auto;
}

.sideMenu{
position:fixed;
top:0;
right:-260px;
width:260px;
height:100%;
background:#111;
border-left:3px solid white;
padding-top:70px;
transition:0.3s;
z-index:1001;
}

.sideMenu.open{
right:0;
}

.sideMenu button{
display:block;
width:80%;
margin:10px auto;
padding:12px;
background:black;
color:white;
border:2px solid white;
cursor:pointer;
}

/* LAYOUT */

.main{
display:flex;
gap:20px;
align-items:flex-start;
}

/* TABLE */

.table{
display:flex;
}

.zeros{
display:flex;
flex-direction:column;
gap:4px;
}

.grid{
display:grid;
grid-template-columns: repeat(12,60px);
grid-template-rows: repeat(3,60px);
gap:4px;
}

.number{
width:60px;
height:60px;
border:3px solid white;
color:white;
position:relative;
cursor:pointer;
}

.cellNumber{
font-weight:bold;
}

.cellProb{
position:absolute;
bottom:2px;
right:4px;
font-size:10px;
}

/* COLORS */

.red{background:#c0392b;}
.black{background:#111;}
.green{background:#1e8449;}

/* HISTORY */

.history{
margin-top:20px;
display:flex;
flex-wrap:wrap;
gap:4px;
background:#111;
padding:10px;
border:3px solid white;
max-width:800px;
justify-content:center;
}

.histCell{
width:30px;
height:30px;
border:2px solid white;
display:flex;
align-items:center;
justify-content:center;
font-size:12px;
}

/* STATS */

.box{
background:#111;
border:3px solid white;
padding:10px;
width:200px;
margin-bottom:10px;
}

.sectorHeat{
display:flex;
gap:10px;
}

.sector{
padding:10px;
border:3px solid white;
width:100px;
}

/* PREDICTION */

.prediction{
background:#111;
border:3px solid white;
padding:10px;
width:200px;
}

</style>
</head>
<body>

<div class="menuButton" onclick="toggleMenu()">â˜°</div>

<div class="overlay" id="overlay" onclick="closeMenu()"></div>

<div class="sideMenu" id="sideMenu">

<button onclick="exportExcel()">Excel</button>
<button onclick="saveJSON()">Save JSON</button>
<button onclick="importJSON()">Import JSON</button>
<button onclick="clearAll()">Clear</button>

</div>

<input type="file" id="fileInput" hidden>

<div class="container">

<h2>Roulette Analyzer PRO</h2>

<div class="main">

<div>

<div class="box">
Bias:<br>
<span id="biasMeter">NONE</span>
</div>

<div class="box">
Accuracy:<br>
<span id="accuracy">0%</span>
</div>

<div class="sectorHeat">

<div class="sector" id="sector1">1-12</div>
<div class="sector" id="sector2">13-24</div>
<div class="sector" id="sector3">25-36</div>

</div>

</div>

<div class="table">

<div class="zeros">

<button class="number green" onclick="addNumber('0')">
<div class="cellNumber">0</div>
<div class="cellProb" id="prob_0">0%</div>
</button>

<button class="number green" onclick="addNumber('00')">
<div class="cellNumber">00</div>
<div class="cellProb" id="prob_00">0%</div>
</button>

</div>

<div class="grid" id="grid"></div>

</div>

<div class="prediction">

<b>Prediction TOP-5</b>

<div id="prediction"></div>

</div>

</div>

<div class="history" id="history"></div>

</div>

<script>

const redNums=[1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];

let history=[];
let count={};

let predictionTotal=0;
let predictionCorrect=0;
let lastPrediction=null;

let sectors=[0,0,0];

for(let i=0;i<=36;i++) count[i]=0;
count["00"]=0;

/* CREATE GRID */

for(let r=3;r>=1;r--){
for(let c=0;c<12;c++){

let n=r+c*3;

let btn=document.createElement("button");

btn.className="number "+getColor(n);

btn.onclick=()=>addNumber(n);

btn.innerHTML=`
<div class="cellNumber">${n}</div>
<div class="cellProb" id="prob_${n}">0%</div>
`;

grid.appendChild(btn);

}
}

/* COLOR */

function getColor(n){

if(n=="0"||n=="00") return "green";
return redNums.includes(Number(n))?"red":"black";

}

/* ADD NUMBER */

function addNumber(n){

if(lastPrediction!=null){

predictionTotal++;
if(lastPrediction==n) predictionCorrect++;

}

history.push(n);

count[n]++;

if(n>=1&&n<=12) sectors[0]++;
if(n>=13&&n<=24) sectors[1]++;
if(n>=25&&n<=36) sectors[2]++;

render();

saveLocal();

}

/* RENDER */

function render(){

let total=history.length||1;

renderHistory();

updateCells(total);
updatePrediction(total);
updateAccuracy();
updateBias(total);
updateSectorHeat(total);

}

/* HISTORY RENDER */

function renderHistory(){

historyDiv.innerHTML="";

history.forEach(n=>{

let cell=document.createElement("div");

cell.className="histCell "+getColor(n);

cell.innerText=n;

historyDiv.appendChild(cell);

});

}

/* PREDICTION */

function updatePrediction(total){

let short=history.slice(-30);

let shortCount={};

short.forEach(n=>shortCount[n]=(shortCount[n]||0)+1);

let arr=Object.keys(count).map(n=>{

let longScore=count[n]/total;
let shortScore=(shortCount[n]||0)/30;

return{n,score:(longScore*0.6)+(shortScore*0.4)};

});

arr.sort((a,b)=>b.score-a.score);

lastPrediction=arr[0].n;

prediction.innerHTML="";

arr.slice(0,5).forEach(x=>{

prediction.innerHTML+=`${x.n} (${(x.score*100).toFixed(2)}%)<br>`;

});

}

/* ACCURACY */

function updateAccuracy(){

let acc=predictionTotal==0?0:
predictionCorrect/predictionTotal*100;

accuracy.innerText=acc.toFixed(1)+"%";

}

/* BIAS */

function updateBias(total){

let expected=total/37;

let max=Math.max(...Object.values(count));

let bias=(max-expected)/expected;

let level="NONE";

if(bias>0.3) level="STRONG";
else if(bias>0.2) level="MEDIUM";
else if(bias>0.1) level="WEAK";

biasMeter.innerText=
level+" ("+(bias*100).toFixed(1)+"%)";

}

/* HEATMAP */

function updateCells(total){

Object.keys(count).forEach(n=>{

let prob=count[n]/total;

let cell=document.getElementById("prob_"+n);

if(cell){

cell.innerText=(prob*100).toFixed(1)+"%";

let intensity=prob*500;

cell.parentElement.style.boxShadow=
`inset 0 0 ${intensity}px rgba(255,0,0,0.8)`;

}

});

}

/* SECTOR HEATMAP */

function updateSectorHeat(total){

sectors.forEach((v,i)=>{

let prob=v/total;

let el=document.getElementById("sector"+(i+1));

el.style.background=
`rgba(255,0,0,${prob})`;

});

}

/* STORAGE */

function saveLocal(){
localStorage.setItem("roulette",JSON.stringify(history));
}

function loadLocal(){

let d=localStorage.getItem("roulette");

if(d) JSON.parse(d).forEach(addNumber);

}

loadLocal();

/* MENU */

function toggleMenu(){
sideMenu.classList.toggle("open");
overlay.classList.toggle("show");
}

function closeMenu(){
sideMenu.classList.remove("open");
overlay.classList.remove("show");
}

/* EXPORT */

function exportExcel(){

let ws=XLSX.utils.json_to_sheet(history.map(n=>({number:n})));

let wb=XLSX.utils.book_new();

XLSX.utils.book_append_sheet(wb,ws,"history");

XLSX.writeFile(wb,"roulette.xlsx");

}

function saveJSON(){

let blob=new Blob([JSON.stringify(history)]);

let a=document.createElement("a");

a.href=URL.createObjectURL(blob);
a.download="roulette.json";
a.click();

}

function importJSON(){

fileInput.click();

}

fileInput.onchange=e=>{

let reader=new FileReader();

reader.onload=()=>{

clearAll();

JSON.parse(reader.result).forEach(addNumber);

};

reader.readAsText(e.target.files[0]);

};

function clearAll(){

history=[];
predictionTotal=0;
predictionCorrect=0;

for(let k in count) count[k]=0;

render();
saveLocal();

}

</script>

</body>
</html>